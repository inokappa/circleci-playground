version: 2
jobs:
  build:
    docker:
      - image: docker:18.06.0-ce-git
    steps:
      - run:
          name: Hello world
          command: |
            echo "Hello CircleCI!!" > hello.txt
      - restore_cache:
          key: cache-date-{{ .Branch }}
      - run:
          name: Restore and Cache data
          command: |
            if [ -f data.txt ];then
              cat date.txt
            else
              date > date.txt
            fi
      - save_cache:
          key: cache-date-{{ .Branch }}
          paths:
            - date.txt
      - run:
          name: Remove date.txt
          command: |
            rm -rf date.txt && sleep 5 && ls -al
      - restore_cache:
          key: cache-date-{{ .Branch }}
      - run:
          name: Restore data
          command: |
            cat date.txt
 
workflows:
  version: 2
  pr-build:
    jobs:
      - build:
          filters:
            branches:
              ignore:
                - master
